Exploring Red wine data by Nika Dogonadze
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.
library(ggplot2)
library(psych)
library(dplyr)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data

wqr = read.csv('wineQualityReds.csv') 
```

This report explors dataset about red wine quality, which can be found [here](https://www.google.com/url?q=https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityReds.csv&sa=D&ust=1508499119744000&usg=AFQjCNE00TiuImFciSXwq5rY9JARtyxktA)

# Univariate Plots Section

```{r echo=FALSE, Univariate_Plots}
dim(wqr)

str(wqr)

summary(wqr)
```

This particular dataset contains 13 variables and just under 1,600 observations. The real number of variables is 12, since x is just the row number. 

```{r}
qplot(x = quality, data = wqr, binwidth=1)
```

The quality of wine ranges from 3 to 8 and seems to have a normal distribution. Most of wines have quality rating of 5 or 6.
Now, Lets look at distribution of other variables

```{r}
qplot(x = fixed.acidity, data = wqr, binwidth=0.5)
```

This parameter shows how much [tartaric acid](https://en.wikipedia.org/wiki/Tartaric_acid) wine contains, given in grams per litre. As can be seen on the graph it has normal distribution which is slightly skewed to the right. Most wines have fixed acidity arount 6-10 grams per litre.


```{r}

qplot(x = volatile.acidity, data = wqr, binwidth=0.02)

```

Volative acidity shows measurement of [acetic acid](https://en.wikipedia.org/wiki/Acetic_acid) in wine, which can be a cause of an unpleasant, vinegar taste. It is given in same units as fixed acidity. It look like bimodal distribution with some outliers having too large values.


```{r}

qplot(x = citric.acid, data = wqr, binwidth=0.03)
nrow(subset(wqr, citric.acid == 0))

```

132 of wines have [citric acid](https://en.wikipedia.org/wiki/Citric_acid) measure of 0. The maximum is 1 grams per litre. 

```{r}

qplot(x = residual.sugar, data = wqr, binwidth=0.2)

```

The measurment of sugar (g per litre) in wine is something I would expect to have a lot of influence on wine quality. However, I have read that wines are only considered sweet after having more than 45 grammes per litre of residual sugar. Maximum in this data is about 15g/litre with most having 4g/litre or less. 


```{r}

qplot(x = chlorides, data = wqr, binwidth=0.01)

```

This parameter show amount of salt in g/litre. It's distirbution looks a lot like sugar distribution. I would imagine this also is important part of wine taste.


```{r}

  qplot(x = free.sulfur.dioxide, data = wqr, binwidth=2)
  qplot(x = total.sulfur.dioxide, data = wqr, binwidth=3)
  qplot(x = sulphates, data = wqr, binwidth=0.05)

```

[sulfur dioxide](https://en.wikipedia.org/wiki/Sulfur_dioxide) can have an influence on microbial growth and win oxidation level. It is not easily detectable in wine taste, unless it is more than 50 parts per million. Sulphates can increase number of sulfur oxides. Sulfur dioxide levels look heavily skewed to the right, lets see them on logarithmic scale.

```{r}
  qplot(x = free.sulfur.dioxide, data = wqr, binwidth=0.2) + 
    scale_x_log10()

  qplot(x = total.sulfur.dioxide, data = wqr, binwidth=0.2) + 
    scale_x_log10()
```

After scaling values to log10 the distributions look normal. Conviniently, we did not have any zeros. 


```{r}
qplot(x = density, data = wqr, binwidth=0.001)

qplot(x = pH, data = wqr, binwidth=0.05)

qplot(x = alcohol, data = wqr, binwidth=0.3)
```

Density, pH level and alcohol concetrations are probably easiest to taste in wine judging from my personal experience. It would be very interesting to see how they influence wine quality. 


# Univariate Analysis

### What is the structure of your dataset?

The dataset consists of 1599 observations of 12 variables (fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.suluf.dioxide, density, pH, sulphates, alcohol, quality)

All the variables are numeric, with no missing values

### What is/are the main feature(s) of interest in your dataset?

The main features of interest are the alcohol level and quality. I am very curious to see which features are best predictors of wine quality. Depending on the answer to this question it might be possible to build a good predictive model using this dataset. 

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?

I think sugar and pH levels will have a lot of influence on wine quality, since those are the things that are easy to taste. 

### Did you create any new variables from existing variables in the dataset?

No, I did not create any new variables from the existing ones.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

I have not made any adjustments to the dataset itself, but I scaled sulfur dioxide levels to logarithmic scale to better understand nature of it's distribution.


# Bivariate Plots Section

Lets first look for the pair that have relatively high correlation, hopefully some variables will be highly correlated to quality.

```{r echo=FALSE, Bivariate_Plots}

corr_table <- as.data.frame(as.table(cor(wqr)))

subset(corr_table, abs(Freq) > 0.5 & Var1 != Var2)

```

Unfortunately, there do not seem to be any strongly correlated values with the quality, But Lets look at all the combinations.

```{r}

pairs.panels(subset(wqr, select = -X))

```

The most correlated variable with quality seems to be the alcohol, and volatile acidity. However other variables are still worth exploring of course.

```{r}
  ggplot(aes(x = alcohol, y = quality), data = wqr) + 
    geom_point()

  wqr %>%
    group_by(quality) %>%
    summarise(mean_alcohol = mean(alcohol),
              median_alcohol = median(alcohol),
              min_alcohol = min(alcohol),
              max_alcohol = max(alcohol))
```

It can be seen from the graph, that higher quality wines generally have higher alcohol concetration. There are quite a few exceptions to this though.

```{r}
  ggplot(aes(x = volatile.acidity, y = quality), data = wqr) + 
    geom_point()

  wqr %>%
    group_by(quality) %>%
    summarise(mean_alcohol = mean(volatile.acidity),
              median_alcohol = median(volatile.acidity),
              min_alcohol = min(volatile.acidity),
              max_alcohol = max(volatile.acidity))
```

Good quality wines have relatively low volatile acidity. The best ones have no more than 0.85 g/litre and the lowest quality wines having as much as 1.58 g/litre.

```{r}
  ggplot(aes(x = pH, y = quality), data = wqr) + 
    geom_point()

  ggplot(aes(x = quality, group = quality, y = pH), data = wqr) + 
    geom_boxplot()
```

  The boxplot graph shows that wines that are ratet with lower quality have higher average pH value. This effect is not evident on scatter plot. Let's look at the residual sugar content now
  
  
```{r}
  ggplot(aes(x = residual.sugar, y = quality), data = wqr) + 
    geom_point()

  wqr %>%
    group_by(quality) %>%
    summarise(mean_alcohol = mean(residual.sugar),
              median_alcohol = median(residual.sugar),
              min_alcohol = min(residual.sugar),
              max_alcohol = max(residual.sugar))
  
  ggplot(aes(x = quality, group = quality, y = residual.sugar), data = wqr) + 
    geom_boxplot()
```

It is against my intuition that residual sugar content would not have an effect in wine quality. I suppose the possible reason could be that the variation between the sugar levels in this dataset is not noticeable enough for human taste to
have an effect. Or maybe wine experts do not pay attention to sweetness when evaluating wines.

```{r}
  ggplot(aes(x = alcohol, y = density), data = wqr) + 
    geom_point() + 
    geom_smooth(method = 'lm')
```

It is clear from the plot and the trendline that wines with higher alcohol levels have lower density. That is quite intuitive because of alcohol's low density.


# Bivariate Analysis


### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

### What was the strongest relationship you found?


# Multivariate Plots Section

> **Tip**: Now it's time to put everything together. Based on what you found in
the bivariate plots section, create a few multivariate plots to investigate
more complex interactions between variables. Make sure that the plots that you
create here are justified by the plots you explored in the previous section. If
you plan on creating any mathematical models, this is the section where you
will do that.

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

> **Tip**: You've done a lot of exploration and have built up an understanding
of the structure of and relationships between the variables in your dataset.
Here, you will select three plots from all of your previous exploration to
present here as a summary of some of your most interesting findings. Make sure
that you have refined your selected plots for good titling, axis labels (with
units), and good aesthetic choices (e.g. color, transparency). After each plot,
make sure you justify why you chose each plot by describing what it shows.

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection

> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.

> **Tip**: Don't forget to remove this, and the other **Tip** sections before
saving your final work and knitting the final report!